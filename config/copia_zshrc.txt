# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘   Custom .zshrc - Shadow-TermDev Configuration           â•‘
# â•‘   Version 2.0.0 - Optimizado para Termux                 â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ---------------------------
# ConfiguraciÃ³n Esencial
# ---------------------------

export ZSH_DISABLE_COMPFIX=true
export HISTFILE=~/.zsh_history
export HISTSIZE=10000
export SAVEHIST=10000
setopt HIST_IGNORE_ALL_DUPS     # No duplicados en historial
setopt HIST_FIND_NO_DUPS         # No mostrar duplicados al buscar
setopt HIST_REDUCE_BLANKS        # Limpiar espacios extra
setopt SHARE_HISTORY             # Compartir historial entre sesiones

# Editor predeterminado
export EDITOR='nano'
export VISUAL='nano'

# PATH personalizado
export PATH="$HOME/.npm-global/bin:$HOME/.local/bin:$PATH"

# ---------------------------
# Oh My Zsh
# ---------------------------

export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="robbyrussell"  # Cambia a: agnoster, bira, clean, etc.

# Plugins
plugins=(
    git
    zsh-autosuggestions
    zsh-syntax-highlighting
    command-not-found
    colored-man-pages
)

# Cargar Oh My Zsh
if [ -f "$ZSH/oh-my-zsh.sh" ]; then
    source "$ZSH/oh-my-zsh.sh"
fi

# ---------------------------
# Autocompletado
# ---------------------------

# Configurar autosuggestions
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=240'
ZSH_AUTOSUGGEST_STRATEGY=(history completion)
ZSH_AUTOSUGGEST_BUFFER_MAX_SIZE=20

# Autocompletado case-insensitive
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
zstyle ':completion:*' menu select

# Habilitar autocompletado
autoload -Uz compinit
compinit

# ---------------------------
# Aliases - Sistema
# ---------------------------

# Listado de archivos (con eza si estÃ¡ disponible)
if command -v eza &> /dev/null; then
    alias ls='eza --icons --group-directories-first --time-style=long-iso'
    alias ll='eza -lah --icons --group-directories-first'
    alias la='eza -a --icons'
    alias lt='eza --tree --level=2 --icons'
    alias l='eza -lh --icons'
else
    alias ls='ls --color=auto'
    alias ll='ls -lah --color=auto'
    alias la='ls -A --color=auto'
    alias l='ls -lh --color=auto'
fi

# NavegaciÃ³n
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias ~='cd ~'
alias -- -='cd -'

# Seguridad en comandos destructivos
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'
alias ln='ln -i'

# ActualizaciÃ³n y limpieza
alias update='pkg update && pkg upgrade'
alias upgrade='pkg upgrade'
alias clean='pkg clean && pkg autoclean'
alias autoremove='pkg autoremove'

# ---------------------------
# Aliases - Herramientas
# ---------------------------

# Cat mejorado (bat)
if command -v bat &> /dev/null; then
    alias cat='bat --style=plain'
    alias catp='bat --style=full'
fi

# Grep con color
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'

# Procesos
alias psa='ps aux'
alias psg='ps aux | grep -v grep | grep -i -e VSZ -e'

# Red
alias myip='curl -s ifconfig.me && echo'
alias localip='ip addr show | grep "inet " | grep -v 127.0.0.1 | cut -d" " -f6'
alias ports='netstat -tulanp'
alias listening='lsof -i -P | grep LISTEN'

# Monitoreo
if command -v htop &> /dev/null; then
    alias top='htop'
fi

# TamaÃ±o de archivos y directorios
alias du='du -h'
alias df='df -h'
alias free='free -h'

# Fecha y hora
alias now='date +"%Y-%m-%d %H:%M:%S"'
alias timestamp='date +%s'
alias week='date +%V'

# ---------------------------
# Aliases - Git
# ---------------------------

alias gs='git status'
alias ga='git add'
alias gaa='git add .'
alias gc='git commit -m'
alias gp='git push'
alias gpl='git pull'
alias gl='git log --oneline --graph --decorate'
alias gd='git diff'
alias gb='git branch'
alias gco='git checkout'
alias gcl='git clone'

# ---------------------------
# Aliases - Desarrollo
# ---------------------------

# Python
alias py='python'
alias py3='python3'
alias pip='pip3'
alias venv='python -m venv'
alias activate='source venv/bin/activate'

# Node.js / npm
alias ni='npm install'
alias nid='npm install --save-dev'
alias nig='npm install -g'
alias nr='npm run'
alias ns='npm start'
alias nt='npm test'

# Directorios de proyectos
alias proj='cd ~/Practice_Projects'
alias pyproj='cd ~/Practice_Projects/Python_Projects'
alias nodeproj='cd ~/Practice_Projects/Nodejs_Projects'
alias webproj='cd ~/Practice_Projects/Web_Projects'

# ---------------------------
# Funciones Ãštiles
# ---------------------------

# Crear directorio y entrar en Ã©l
mkcd() {
    mkdir -p "$1" && cd "$1"
}

# Extraer archivos comprimidos
extract() {
    if [ -f "$1" ]; then
        case "$1" in
            *.tar.bz2)   tar xjf "$1"     ;;
            *.tar.gz)    tar xzf "$1"     ;;
            *.bz2)       bunzip2 "$1"     ;;
            *.rar)       unrar x "$1"     ;;
            *.gz)        gunzip "$1"      ;;
            *.tar)       tar xf "$1"      ;;
            *.tbz2)      tar xjf "$1"     ;;
            *.tgz)       tar xzf "$1"     ;;
            *.zip)       unzip "$1"       ;;
            *.Z)         uncompress "$1"  ;;
            *.7z)        7z x "$1"        ;;
            *)           echo "'$1' no puede ser extraÃ­do con extract()" ;;
        esac
    else
        echo "'$1' no es un archivo vÃ¡lido"
    fi
}

# Buscar archivo por nombre
fnd() {
    find . -iname "*$1*" 2>/dev/null
}

# Buscar en archivos
grp() {
    grep -r "$1" . 2>/dev/null
}

# Crear backup de un archivo
backup() {
    cp "$1" "$1.backup-$(date +%Y%m%d-%H%M%S)"
}

# Calcular tamaÃ±o de directorio
dirsize() {
    du -sh "${1:-.}" 2>/dev/null
}

# InformaciÃ³n del sistema
sysinfo() {
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘        INFORMACIÃ“N DEL SISTEMA            â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Hostname: $(hostname)"
    echo "Uptime: $(uptime -p)"
    echo "Kernel: $(uname -r)"
    echo "Shell: $SHELL"
    echo "Terminal: $TERM"
    echo ""
    echo "Memoria:"
    free -h
    echo ""
    echo "Almacenamiento:"
    df -h | grep -E '^/|Filesystem'
}

# Servidor HTTP simple
serve() {
    local port="${1:-8000}"
    python -m http.server "$port"
}

# Ver historial mÃ¡s limpio
h() {
    if [ -z "$1" ]; then
        history 20
    else
        history | grep "$1"
    fi
}

# Crear script ejecutable
newscript() {
    if [ -z "$1" ]; then
        echo "Uso: newscript nombre_script.sh"
        return 1
    fi
    
    echo '#!/usr/bin/env bash' > "$1"
    echo '' >> "$1"
    echo '# Script creado el '$(date +"%Y-%m-%d %H:%M:%S") >> "$1"
    echo '' >> "$1"
    chmod +x "$1"
    echo "Script '$1' creado y hecho ejecutable"
}

# ---------------------------
# ConfiguraciÃ³n de Seguridad
# ---------------------------

# Permisos de archivos por defecto
umask 077

# ---------------------------
# Keybindings
# ---------------------------

# Ctrl+H para borrar palabra hacia atrÃ¡s
bindkey "^H" backward-kill-word

# Ctrl+Left/Right para mover palabra
bindkey "^[[1;5D" backward-word
bindkey "^[[1;5C" forward-word

# Home y End
bindkey "^[[H" beginning-of-line
bindkey "^[[F" end-of-line

# Delete
bindkey "^[[3~" delete-char

# ---------------------------
# Prompt Personalizado
# ---------------------------

# Colores para prompt (solo si no estÃ¡s usando un tema de Oh My Zsh)
# autoload -U colors && colors
# PROMPT='%{$fg[cyan]%}%n@%m %{$fg[yellow]%}%~ %{$fg[green]%}â†’ %{$reset_color%}'

# ---------------------------
# Welcome Message
# ---------------------------

if [ -f "$HOME/.hushlogin" ]; then
    # No mostrar mensaje de bienvenida
    :
else
    # Banner de bienvenida
    if command -v figlet &> /dev/null && command -v lolcat &> /dev/null; then
        clear
        figlet -f small "Termux" 2>/dev/null | lolcat -f 2>/dev/null || echo "=== Termux ==="
        echo ""
    fi
    
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘   Bienvenido a tu Termux personalizado   â•‘"
    echo "â•‘         Custom-SetUp v2.0.0               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "ğŸ’¡ Tips rÃ¡pidos:"
    echo "   â€¢ Escribe 'sysinfo' para ver informaciÃ³n del sistema"
    echo "   â€¢ Usa 'proj' para ir a tus proyectos"
    echo "   â€¢ Ejecuta 'update' para actualizar paquetes"
    echo ""
    echo "ğŸ“š DocumentaciÃ³n: https://Shadow-TermDev.github.io"
    echo ""
    
    # Ocultar este mensaje en futuras sesiones (opcional)
    # touch ~/.hushlogin
fi

# ---------------------------
# ConfiguraciÃ³n Final
# ---------------------------

# Cargar configuraciones locales si existen
[ -f ~/.zshrc.local ] && source ~/.zshrc.local

# Cargar configuraciones de trabajo si existen
[ -f ~/.zshrc.work ] && source ~/.zshrc.work

# Limpiar variables temporales
unset file

# ---------------------------
# FIN DE CONFIGURACIÃ“N
# ---------------------------
